"use strict";(self.webpackChunkcode_docs=self.webpackChunkcode_docs||[]).push([[1608],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>k});var r=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var l=r.createContext({}),s=function(e){var t=r.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},c=function(e){var t=s(e.components);return r.createElement(l.Provider,{value:t},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,l=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),m=s(a),u=n,k=m["".concat(l,".").concat(u)]||m[u]||d[u]||i;return a?r.createElement(k,o(o({ref:t},c),{},{components:a})):r.createElement(k,o({ref:t},c))}));function k(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,o=new Array(i);o[0]=u;var p={};for(var l in t)hasOwnProperty.call(t,l)&&(p[l]=t[l]);p.originalType=e,p[m]="string"==typeof e?e:n,o[1]=p;for(var s=2;s<i;s++)o[s]=a[s];return r.createElement.apply(null,o)}return r.createElement.apply(null,a)}u.displayName="MDXCreateElement"},504:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>p,toc:()=>s});var r=a(7462),n=(a(7294),a(3905));const i={sidebar_position:3},o="RDD v\xe0 DataFrame",p={unversionedId:"pyspark/RDD v\xe0 DataFrame",id:"pyspark/RDD v\xe0 DataFrame",title:"RDD v\xe0 DataFrame",description:"Resilient Distributed Dataset l\xe0 th\xe0nh ph\u1ea7n core nh\u1ea5t c\u1ee7a spark. N\xf3 g\u1ed3m c\xe1c t\xednh ch\u1ea5t sau",source:"@site/docs/pyspark/RDD v\xe0 DataFrame.mdx",sourceDirName:"pyspark",slug:"/pyspark/RDD v\xe0 DataFrame",permalink:"/second-documentation/docs/pyspark/RDD v\xe0 DataFrame",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/pyspark/RDD v\xe0 DataFrame.mdx",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"M\xf4 h\xecnh ho\u1ea1t \u0111\u1ed9ng c\u1ee7a pyspark",permalink:"/second-documentation/docs/pyspark/M\xf4 h\xecnh Spark"},next:{title:"Quy t\u1eafc x\u1eed l\xed d\u1eef li\u1ec7u",permalink:"/second-documentation/docs/pyspark/Quy t\u1eafc x\u1eed l\xed d\u1eef li\u1ec7u"}},l={},s=[{value:"\u0110\u1ec3 t\u1ea1o ra 1 RDD",id:"\u0111\u1ec3-t\u1ea1o-ra-1-rdd",level:2},{value:"\u0110\u1ec3 t\u1ea1o ra 1 DataFrame",id:"\u0111\u1ec3-t\u1ea1o-ra-1-dataframe",level:2}],c={toc:s},m="wrapper";function d(e){let{components:t,...a}=e;return(0,n.kt)(m,(0,r.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"rdd-v\xe0-dataframe"},"RDD v\xe0 DataFrame"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Resilient Distributed Dataset")," l\xe0 th\xe0nh ph\u1ea7n core nh\u1ea5t c\u1ee7a spark. N\xf3 g\u1ed3m c\xe1c t\xednh ch\u1ea5t sau"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Resilient"),": immutable"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Distributed"),": Dataset \u0111c chia th\xe0nh c\xe1c partition v\xe0 c\u1ea5p ph\xe1t cho worker node l\xe0m vi\u1ec7c")),(0,n.kt)("p",null,"Spark ho\u1ea1t \u0111\u1ed9ng d\u1ef1a tr\xean RDD, tuy nhi\xean n\xf3 ko native v\u1edbi python. Do \u0111\xf3, khi d\xf9ng pyspark, ta thao t\xe1c v\u1edbi 1 c\u1ea5u tr\xfac Spark Dataframe build on top of RDD."),(0,n.kt)("p",null,"RDD actions and transformation"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Transformation")," l\xe0 dirty and lazy operation"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},(0,n.kt)("em",{parentName:"strong"},"dirty"))," t\u1ee9c n\xf3 ko l\u1eadp t\u1ee9c th\u1ef1c hi\u1ec7n. C\xe1c transformation only th\u1ef1c hi\u1ec7n khi c\xf3 m\u1ed9t action \u0111\u01b0\u1ee3c th\u1ef1c thi"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},(0,n.kt)("em",{parentName:"strong"},"lazy"))," l\xe0 n\xf3 tr\u1ea3 v\u1ec1 1 RDD kh\xe1c, thay v\xec mutate c\xe1i RDD c\u0169"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"c\xe1c ph\xe9p ",(0,n.kt)("inlineCode",{parentName:"p"},"transformation")," l\xe0 c\xe1c functional operations bao g\u1ed3m ",(0,n.kt)("inlineCode",{parentName:"p"},"flatMap()"),",\xa0",(0,n.kt)("inlineCode",{parentName:"p"},"map()"),",\xa0",(0,n.kt)("inlineCode",{parentName:"p"},"reduceByKey()"),",\xa0",(0,n.kt)("inlineCode",{parentName:"p"},"filter()"),",\xa0",(0,n.kt)("inlineCode",{parentName:"p"},"sortByKey()"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Actions")," returns the\xa0values from an RDD to a driver node. N\xf3 bao g\u1ed3m aggregations nh\u01b0 ",(0,n.kt)("inlineCode",{parentName:"p"},"count()"),",\xa0",(0,n.kt)("inlineCode",{parentName:"p"},"collect()"),",\xa0",(0,n.kt)("inlineCode",{parentName:"p"},"first()"),",\xa0",(0,n.kt)("inlineCode",{parentName:"p"},"max()"),",\xa0",(0,n.kt)("inlineCode",{parentName:"p"},"reduce()")))),(0,n.kt)("h2",{id:"\u0111\u1ec3-t\u1ea1o-ra-1-rdd"},"\u0110\u1ec3 t\u1ea1o ra 1 RDD"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-python",metastring:'title="T\u1eeb list"',title:'"T\u1eeb','list"':!0},'dataList = [("Java", 20000), ("Python", 100000), ("Scala", 3000)]\nrdd=spark.sparkContext.parallelize(dataList)\n')),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-python",metastring:'title="T\u1eeb file csv"',title:'"T\u1eeb',file:!0,'csv"':!0},"file_path = \"/datasets/airports.csv\"\nairports_rdd = spark.read.csv(file_path, header=True, inferSchema=True, nullValue='NA')\n")),(0,n.kt)("h2",{id:"\u0111\u1ec3-t\u1ea1o-ra-1-dataframe"},"\u0110\u1ec3 t\u1ea1o ra 1 DataFrame"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-python",metastring:'title="T\u1eeb list (enforce schema)"',title:'"T\u1eeb',list:!0,"(enforce":!0,'schema)"':!0},'from pyspark.sql.types import StructType, StructField, StringType, IntegerType\n\ndata = [("James",3000), ("Michael",4000)]\n\nschema = StructType([ \\\n    StructField("firstname",StringType(),True), \\\n    StructField("salary", IntegerType(), True) \\\n  ])\n\ndf = spark.createDataFrame(data=data,schema=schema)\n')),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-python",metastring:'title="T\u1eeb csv"',title:'"T\u1eeb','csv"':!0},"df = spark.read.options(inferSchema='True',delimiter=',').csv('path')\n")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-python",metastring:'title="T\u1eeb RDD"',title:'"T\u1eeb','RDD"':!0},'deptColumns = ["dept_name","dept_id"]\ndf = rdd.toDF(deptColumns)\n')),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-python",metastring:'title="T\u1eeb pandas"',title:'"T\u1eeb','pandas"':!0},"dff.iteritems = dff.items # t\u1ea1i phi\xean b\u1ea3n pandas >= 2, ta ph\u1ea3i d\xf9ng th\xeam syntax\ntest_output = spark.createDataFrame(dff)\n")))}d.isMDXComponent=!0}}]);